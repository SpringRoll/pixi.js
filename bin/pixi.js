/**
 * @license
 * Pixi.JS - v1.0.0
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2013-07-23
 *
 * Pixi.JS is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(){function a(a){return[(255&a>>16)/255,(255&a>>8)/255,(255&a)/255]}function b(a){var b=a.substring(a.lastIndexOf("/")+1);return-1!=b.indexOf("?")&&(b=b.substring(0,b.indexOf("?"))),b}function c(){return e.Matrix="undefined"!=typeof Float32Array?Float32Array:Array,e.Matrix}var d=this,e=e||{};e.Point=function(a,b){this.x=a||0,this.y=b||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.dotProd=function(a){return this.x*a.x+this.y*a.y},e.Point.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.Point.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},e.Point.prototype.normalize=function(){var a=1/this.length();this.x*=a,this.y*=a},e.Point.constructor=e.Point,e.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.constructor=e.Rectangle,e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.worldVisible=!1,this.parent=null,this.stage=null,this.hitArea=null,this.worldAlpha=1,this.color=[],this.worldTransform=e.mat3.create(),this.localTransform=e.mat3.create(),this.dynamic=!0,this._sr=0,this._cr=1,this.childIndex=0,this.renderable=!1,this.interactive=!1,this.buttonMode=!1},e.DisplayObject.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(a){this.interactive=a,this.stage&&(this.stage.dirty=!0)},e.DisplayObject.prototype.updateTransform=function(){this.rotation!=this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var a=this.localTransform,b=this.parent.worldTransform,c=this.worldTransform,d=this.scale.x,e=this.scale.y,f=a[0]=this._cr*d,g=a[1]=-this._sr*e,h=a[3]=this._sr*d,i=a[4]=this._cr*e,j=this.pivot.x,k=this.pivot.y,l=a[2]=this.position.x-f*j-k*g,m=a[5]=this.position.y-i*k-j*h,n=b[0],o=b[1],p=b[2],q=b[3],r=b[4],s=b[5];c[0]=n*f+o*h,c[1]=n*g+o*i,c[2]=n*l+o*m+p,c[3]=q*f+r*h,c[4]=q*g+r*i,c[5]=q*l+r*m+s,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[],this.renderable=!1},e.DisplayObjectContainer.constructor=e.DisplayObjectContainer,e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.addChild=function(a){void 0!=a.parent&&a.parent.removeChild(a),a.parent=this,a.childIndex=this.children.length,this.children.push(a),this.stage&&this.stage.__addChild(a),this.__renderGroup&&(a.__renderGroup&&a.__renderGroup.removeDisplayObjectAndChildren(a),this.__renderGroup.addDisplayObjectAndChildren(a))},e.DisplayObjectContainer.prototype.addChildAt=function(a,b){if(!(b>=0&&b<=this.children.length))throw new Error(a+" The index "+b+" supplied is out of bounds "+this.children.length);void 0!=a.parent&&a.parent.removeChild(a),b==this.children.length?this.children.push(a):this.children.splice(b,0,a),a.parent=this,a.childIndex=b;for(var c=this.children.length,d=b;c>d;d++)this.children[d].childIndex=d;this.stage&&this.stage.__addChild(a),this.__renderGroup&&(a.__renderGroup&&a.__renderGroup.removeDisplayObjectAndChildren(a),this.__renderGroup.addDisplayObjectAndChildren(a))},e.DisplayObjectContainer.prototype.swapChildren=function(a,b){var c=this.children.indexOf(a),d=this.children.indexOf(b);if(-1===c||-1===d)throw new Error(a+" Both the supplied DisplayObjects must be a child of the caller "+this);this.stage&&(this.stage.__removeChild(a),this.stage.__removeChild(b),this.stage.__addChild(a),this.stage.__addChild(b)),a.childIndex=d,b.childIndex=c,this.children[c]=b,this.children[d]=a},e.DisplayObjectContainer.prototype.getChildAt=function(a){if(a>=0&&a<this.children.length)return this.children[a];throw new Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this)},e.DisplayObjectContainer.prototype.removeChild=function(a){var b=this.children.indexOf(a);if(-1===b)throw new Error(a+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&this.stage.__removeChild(a),a.__renderGroup&&a.__renderGroup.removeDisplayObjectAndChildren(a),a.parent=void 0,this.children.splice(b,1);for(var c=b,d=this.children.length;d>c;c++)this.children[c].childIndex-=1},e.DisplayObjectContainer.prototype.removeChildren=function(a){if(0!=this.children.length){"undefined"==typeof a&&(a=0);for(var b=this.children.length-1;b>=a;--b){var c=this.children[b];this.stage&&this.stage.__removeChild(c),c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c),c.parent=void 0}this.children.length=a}},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){e.DisplayObject.prototype.updateTransform.call(this);for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform()}},e.blendModes={},e.blendModes.NORMAL=0,e.blendModes.SCREEN=1,e.Sprite=function(a){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=a,this.texture.realSize&&(this.pivot.x=this.texture.realSize.x,this.pivot.y=this.texture.realSize.y),this.blendMode=e.blendModes.NORMAL,this._width=0,this._height=0,a.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.constructor=e.Sprite,e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.width},set:function(a){this.scale.x=a/this.texture.width,this._width=a}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.height},set:function(a){this.scale.y=a/this.texture.height,this._height=a}}),e.Sprite.prototype.setTexture=function(a){this.texture.baseTexture!=a.baseTexture&&(this.textureChange=!0),this.texture=a,this.updateFrame=!0,this.texture.realSize&&(this.pivot.x=this.texture.realSize.x,this.pivot.y=this.texture.realSize.y)},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.width),this._height&&(this.scale.y=this._height/this.texture.height),this.updateFrame=!0},e.Sprite.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error("The frameId '"+a+"' does not exist in the texture cache"+this);return new e.Sprite(b)},e.Sprite.fromImage=function(a){var b=e.Texture.fromImage(a);return new e.Sprite(b)},e.MovieClip=function(a){e.Sprite.call(this,a[0]),this.textures=a,this.currentFrame=0,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.playing,this._animFrameRate=30,this._elapsedTime=0,this._animDuration=0},e.MovieClip.constructor=e.MovieClip,e.MovieClip.prototype=Object.create(e.Sprite.prototype),Object.defineProperty(e.MovieClip.prototype,"fps",{get:function(){return this._animFrameRate},set:function(a){this._animFrameRate=a,this._elapsedTime=0,this._duration=a?this.textures.length/a:0}}),e.MovieClip.prototype.updateDuration=function(){this._duration=this._animFrameRate?this.textures.length/this._animFrameRate:0},e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(a){this.playing=!1,this.currentFrame=a,this._elapsedTime=a/this._animFrameRate,this.setTexture(this.textures[a%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(a){this._elapsedTime=a/this._animFrameRate,this.currentFrame=a,this.playing=!0},e.MovieClip.prototype.updateAnim=function(a){this._elapsedTime+=a*this.animationSpeed},e.MovieClip.prototype.updateTransform=function(){if(this.playing){var a=!1;this._elapsedTime>this._duration&&(this.loop?this._elapsedTime=this._elapsedTime%this._duration:(this._elapsedTime=this._duration,a=!0,this.playing=!1)),this.currentFrame=0|this._elapsedTime*this._animFrameRate,this.currentFrame>=this.textures.length&&(this.currentFrame=this.textures.length-1),this.setTexture(this.textures[this.currentFrame]),a&&this.onComplete&&this.onComplete()}e.Sprite.prototype.updateTransform.call(this)},e.Text=function(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},e.Text.constructor=e.Text,e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.setStyle=function(a){a=a||{},a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,this.style=a,this.dirty=!0},e.Sprite.prototype.setText=function(a){this.text=a.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.wordWrap(this.text));for(var b=a.split(/(?:\r\n|\r|\n)/),c=[],d=0,f=0;f<b.length;f++){var g=this.context.measureText(b[f]).width;c[f]=g,d=Math.max(d,g)}this.canvas.width=d+this.style.strokeThickness;var h=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;this.canvas.height=h*b.length,this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.style.stroke&&(this.context.strokeStyle=this.style.stroke),this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var i=new e.Point(.5*this.style.strokeThickness,0);for(f=0;f<b.length;f++)i.y=.5*this.style.strokeThickness+f*h,"right"==this.style.align?i.x+=d-c[f]:"center"==this.style.align&&(i.x+=.5*(d-c[f])),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(b[f],i.x,i.y),this.style.fill&&this.context.fillText(b[f],i.x,i.y);this.updateTexture()},e.Text.prototype.updateTexture=function(){this._width=this.texture.width=this.texture.frame.width=this.texture.baseTexture.width=this.canvas.width,this._height=this.texture.height=this.texture.frame.height=this.texture.baseTexture.height=this.canvas.height,e.texturesToUpdate.push(this.texture.baseTexture)},e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.Sprite.prototype.updateTransform.call(this)},e.Text.prototype.determineFontHeight=function(a){var b=e.Text.heightCache[a];if(!b){var c=document.getElementsByTagName("body")[0],d=document.createElement("div"),f=document.createTextNode("M");d.appendChild(f),d.setAttribute("style",a+";position:absolute;top:0;left:0"),c.appendChild(d),b=d.offsetHeight,e.Text.heightCache[a]=b,c.removeChild(d)}return b},e.Text.prototype.wordWrap=function(a){for(var b=function(a,b,c,d,e){var f=Math.floor((d-c)/2)+c;return f==c?1:a.measureText(b.substring(0,f)).width<=e?a.measureText(b.substring(0,f+1)).width>e?f:arguments.callee(a,b,f,d,e):arguments.callee(a,b,c,f,e)},c=function(a,c,d){if(a.measureText(c).width<=d||c.length<1)return c;var e=b(a,c,0,c.length,d);return c.substring(0,e)+"\n"+arguments.callee(a,c.substring(e),d)},d="",e=a.split("\n"),f=0;f<e.length;f++)d+=c(this.context,e[f],this.style.wordWrapWidth)+"\n";return d},e.Text.prototype.destroy=function(a){a&&this.texture.destroy()},e.Text.heightCache={},e.BitmapText=function(a,b){e.DisplayObjectContainer.call(this),this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},e.BitmapText.constructor=e.BitmapText,e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.setText=function(a){this.text=a||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(a){a=a||{},a.align=a.align||"left",this.style=a;var b=a.font.split(" ");this.fontName=b[b.length-1],this.fontSize=b.length>=2?parseInt(b[b.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0},e.BitmapText.prototype.updateText=function(){for(var a=e.BitmapText.fonts[this.fontName],b=new e.Point,c=null,d=[],f=0,g=[],h=0,i=this.fontSize/a.size,j=this.text,k=/(?:\r\n|\r|\n)/,l=0,m=j.length;m>l;l++)if(k.test(j.charAt(l)))g.push(b.x),f=Math.max(f,b.x),h++,b.x=0,b.y+=a.lineHeight,c=null;else{var n=j.charCodeAt(l),o=a.chars[n];o&&(c&&o[c]&&(b.x+=o.kerning[c]),d.push({texture:o.texture,line:h,charCode:n,position:new e.Point(b.x+o.xOffset,b.y+o.yOffset)}),b.x+=o.xAdvance,c=n)}g.push(b.x),f=Math.max(f,b.x);var p=[],q=this.style.align;for(l=0;h>=l;l++){var r=0;"right"==q?r=f-g[l]:"center"==q&&(r=.5*(f-g[l])),p.push(r)}for(l=0;l<d.length;l++){var s=new e.Sprite(d[l].texture);s.position.x=(d[l].position.x+p[d[l].line])*i,s.position.y=d[l].position.y*i,s.scale.x=s.scale.y=i,this.addChild(s)}this.width=b.x*i,this.height=(b.y+a.lineHeight)*i},e.BitmapText.prototype.forceUpdateText=function(){for(var a=this.children;a.length>0;)this.removeChild(this.getChildAt(0));this.updateText(),this.dirty=!1},e.BitmapText.prototype.updateTransform=function(){this.dirty&&this.forceUpdateText(),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionManager=function(a){this.stage=a,this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.mouse=new e.InteractionData,this.touchs={},this.pool=[],this.interactiveItems=[],this.last=0},e.InteractionManager.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(a,b){for(var c=a.children,d=c.length,e=d-1;e>=0;e--){var f=c[e];f.visible&&(f.interactive?(b.interactiveChildren=!0,this.interactiveItems.push(f),f.children.length>0&&this.collectInteractiveSprite(f,f)):(f.__iParent=null,f.children.length>0&&this.collectInteractiveSprite(f,b)))}},e.InteractionManager.prototype.setTarget=function(a){window.navigator.msPointerEnabled&&(a.view.style["-ms-content-zooming"]="none",a.view.style["-ms-touch-action"]="none"),this.target=a,a.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0),a.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.body.addEventListener("mouseup",this.onMouseUp.bind(this),!0),a.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0),a.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0),a.view.addEventListener("touchend",this.onTouchEnd.bind(this),!0),a.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)},e.InteractionManager.prototype.update=function(a){if(!a){if(!this.target)return;var b=Date.now(),c=b-this.last;if(c=30*c/1e3,1>c)return;this.last=b}var d=this.interactiveItems.length;if(this.dirty){this.dirty=!1;for(var e=0;d>e;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&(this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)),d=this.interactiveItems.length}this.target.view.style.cursor="default";for(var e=0;d>e;e++){var f=this.interactiveItems[e];f.visible&&(f.mouseover||f.mouseout||f.buttonMode)&&(f.__hit=this.hitTest(f,this.mouse),f.__hit?(f.buttonMode&&(this.target.view.style.cursor="pointer"),f.__isOver||(f.mouseover&&f.mouseover(this.mouse),f.__isOver=!0)):f.__isOver&&(f.mouseout&&f.mouseout(this.mouse),f.__isOver=!1))}},e.InteractionManager.prototype.onMouseMove=function(a){a.preventDefault();var b=this.target.view.getBoundingClientRect();this.mouse.global.x=(a.clientX-b.left)*(this.target.width/b.width),this.mouse.global.y=(a.clientY-b.top)*(this.target.height/b.height);var c=this.interactiveItems.length;this.mouse.global;for(var d=0;c>d;d++){var e=this.interactiveItems[d];e.mousemove&&e.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(a){a.preventDefault();var b=this.interactiveItems.length;this.mouse.global,this.stage;for(var c=0;b>c;c++){var d=this.interactiveItems[c];if((d.mousedown||d.click)&&(d.__mouseIsDown=!0,d.__hit=this.hitTest(d,this.mouse),d.__hit&&(d.mousedown&&d.mousedown(this.mouse),d.__isDown=!0,!d.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseUp=function(a){a.preventDefault(),this.mouse.global;for(var b=this.interactiveItems.length,c=!1,d=0;b>d;d++){var e=this.interactiveItems[d];e&&(e.mouseup||e.mouseupoutside||e.click)&&(e.__hit=this.hitTest(e,this.mouse),e.__hit&&!c?(e.mouseup&&e.mouseup(this.mouse),e.__isDown&&e.click&&e.click(this.mouse),e.interactiveChildren||(c=!0)):e.__isDown&&e.mouseupoutside&&e.mouseupoutside(this.mouse),e.__isDown=!1)}},e.InteractionManager.prototype.hitTest=function(a,b){if(!a.visible)return!1;var c=b.global;if(a.hitArea){var d=a.worldTransform,f=a.hitArea,g=d[0],h=d[1],i=d[2],j=d[3],k=d[4],l=d[5],m=1/(g*k+h*-j),n=k*m*c.x+-h*m*c.y+(l*h-i*k)*m,o=g*m*c.y+-j*m*c.x+(-l*g+i*j)*m,p=f.x;if(n>p&&n<p+f.width){var q=f.y;if(o>q&&o<q+f.height)return!0}}else if(a instanceof e.Sprite){var d=a.worldTransform,g=d[0],h=d[1],i=d[2],j=d[3],k=d[4],l=d[5],m=1/(g*k+h*-j),n=k*m*c.x+-h*m*c.y+(l*h-i*k)*m,o=g*m*c.y+-j*m*c.x+(-l*g+i*j)*m,r=a.texture.frame.width,s=a.texture.frame.height,p=-r*a.anchor.x;if(n>p&&p+r>n){var q=-s*a.anchor.y;if(o>q&&q+s>o)return b.target=a,!0}}for(var t=a.children.length,u=0;t>u;u++){var v=a.children[u],w=this.hitTest(v,b);if(w)return!0}return!1},e.InteractionManager.prototype.onTouchMove=function(a){a.preventDefault();for(var b=this.target.view.getBoundingClientRect(),c=a.changedTouches,d=this.target.width/b.width,e=this.target.height/b.height,f=0,g=c.length;g>f;f++){var h=c[f],i=this.touchs[h.identifier];i.global.x=(h.clientX-b.left)*d,i.global.y=(h.clientY-b.top)*e}for(var j=this.interactiveItems.length,f=0;j>f;f++){var k=this.interactiveItems[f];k.touchmove&&k.touchmove(i)}},e.InteractionManager.prototype.onTouchStart=function(a){a.preventDefault();for(var b=this.target.view.getBoundingClientRect(),c=a.changedTouches,d=this.target.width/b.width,f=this.target.height/b.height,g=0,h=c.length;h>g;g++){var i=c[g],j=this.pool.pop();j||(j=new e.InteractionData),this.touchs[i.identifier]=j,j.global.x=(i.clientX-b.left)*d,j.global.y=(i.clientY-b.top)*f;for(var k=this.interactiveItems.length,l=0;k>l;l++){var m=this.interactiveItems[l];if((m.touchstart||m.tap)&&(m.__hit=this.hitTest(m,j),m.__hit&&(m.touchstart&&m.touchstart(j),m.__isDown=!0,m.__touchData=j,!m.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(a){a.preventDefault();for(var b=this.target.view.getBoundingClientRect(),c=a.changedTouches,d=this.target.width/b.width,e=this.target.height/b.height,f=0,g=c.length;g>f;f++){var h=c[f],i=this.touchs[h.identifier],j=!1;i.global.x=(h.clientX-b.left)*d,i.global.y=(h.clientY-b.top)*e;for(var k=this.interactiveItems.length,l=0;k>l;l++){var m=this.interactiveItems[l];if(m){var n=m.__touchData;m.__hit=this.hitTest(m,i),n==i&&((m.touchend||m.tap)&&(m.__hit&&!j?(m.touchend&&m.touchend(i),m.__isDown&&m.tap&&m.tap(i),m.interactiveChildren||(j=!0)):m.__isDown&&m.touchendoutside&&m.touchendoutside(i),m.__isDown=!1),m.__touchData=null)}}this.pool.push(i),this.touchs[h.identifier]=null}},e.InteractionData=function(){this.global=new e.Point,this.local=new e.Point,this.target},e.InteractionData.prototype.getLocalPosition=function(a){var b=a.worldTransform,c=this.global,d=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5],k=1/(d*i+f*-h);return new e.Point(i*k*c.x+-f*k*c.y+(j*f-g*i)*k,d*k*c.y+-h*k*c.x+(-j*d+g*h)*k)},e.InteractionData.constructor=e.InteractionData,e.Stage=function(a,b){e.DisplayObjectContainer.call(this),this.worldTransform=e.mat3.create(),this.__childrenAdded=[],this.__childrenRemoved=[],this.childIndex=0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.interactive=!!b,this.interactionManager=new e.InteractionManager(this),this.setBackgroundColor(a),this.worldVisible=!0,this.stage.dirty=!0},e.Stage.constructor=e.Stage,e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.forceUpdateInteraction=function(){this.interactionManager.dirty=!0,this.interactionManager.update(!0)},e.Stage.prototype.setBackgroundColor=function(b){this.backgroundColor=b||0,this.backgroundColorSplit=a(this.backgroundColor),this.backgroundColorString="#"+this.backgroundColor.toString(16)},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},e.Stage.prototype.__addChild=function(a){if(a.interactive&&(this.dirty=!0),a.stage=this,a.children)for(var b=0;b<a.children.length;b++)this.__addChild(a.children[b])},e.Stage.prototype.__removeChild=function(a){if(a.interactive&&(this.dirty=!0),a.stage=void 0,a.children)for(var b=0,c=a.children.length;c>b;b++)this.__removeChild(a.children[b])};for(var f=0,g=["ms","moz","webkit","o"],h=0;h<g.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[g[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[g[h]+"CancelAnimationFrame"]||window[g[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-f)),d=window.setTimeout(function(){a(b+c)},c);return f=b+c,d}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.requestAnimFrame=window.requestAnimationFrame,"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(b){function c(){var f=e.concat(a.call(arguments));d.apply(this instanceof c?this:b,f)}var d=this,e=a.call(arguments,1);if("function"!=typeof d)throw new TypeError;return c.prototype=function f(a){return a&&(f.prototype=a),this instanceof f?void 0:new f}(d.prototype),c}}());var i=function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:!1;for(var b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(c){}};Math.PI_OVER_180=Math.PI/180,e.EventTarget=function(){var a={};this.addEventListener=this.on=function(b,c){void 0===a[b]?a[b]=[c]:-1===a[b].indexOf(c)&&a[b].push(c)},this.dispatchEvent=this.emit=function(b){for(var c in a[b.type])a[b.type][c](b)},this.removeEventListener=this.off=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)}},c(),e.mat3={},e.mat3.create=function(){var a=new e.Matrix(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.mat4={},e.mat4.create=function(){var a=new e.Matrix(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.mat3.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=b[0],n=b[1],o=b[2],p=b[3],q=b[4],r=b[5],s=b[6],t=b[7],u=b[8];return c[0]=m*d+n*g+o*j,c[1]=m*e+n*h+o*k,c[2]=m*f+n*i+o*l,c[3]=p*d+q*g+r*j,c[4]=p*e+q*h+r*k,c[5]=p*f+q*i+r*l,c[6]=s*d+t*g+u*j,c[7]=s*e+t*h+u*k,c[8]=s*f+t*i+u*l,c},e.mat3.toMat4=function(a,b){return b||(b=e.mat4.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},e.mat4.create=function(){var a=new e.Matrix(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.mat4.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=d,a[9]=f,a[11]=a[14],a[12]=e,a[13]=g,a[14]=h,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},e.mat4.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14],s=a[15],t=b[0],u=b[1],v=b[2],w=b[3];return c[0]=t*d+u*h+v*l+w*p,c[1]=t*e+u*i+v*m+w*q,c[2]=t*f+u*j+v*n+w*r,c[3]=t*g+u*k+v*o+w*s,t=b[4],u=b[5],v=b[6],w=b[7],c[4]=t*d+u*h+v*l+w*p,c[5]=t*e+u*i+v*m+w*q,c[6]=t*f+u*j+v*n+w*r,c[7]=t*g+u*k+v*o+w*s,t=b[8],u=b[9],v=b[10],w=b[11],c[8]=t*d+u*h+v*l+w*p,c[9]=t*e+u*i+v*m+w*q,c[10]=t*f+u*j+v*n+w*r,c[11]=t*g+u*k+v*o+w*s,t=b[12],u=b[13],v=b[14],w=b[15],c[12]=t*d+u*h+v*l+w*p,c[13]=t*e+u*i+v*m+w*q,c[14]=t*f+u*j+v*n+w*r,c[15]=t*g+u*k+v*o+w*s,c},e.autoDetectRenderer=function(a,b,c,d){a||(a=800),b||(b=600);var f=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return!1}}();return f?new e.WebGLRenderer(a,b,c,d):new e.CanvasRenderer(a,b,c,d)},e.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],e.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat4 uMVMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],e.CompileVertexShader=function(a,b){return e._CompileShader(a,b,a.VERTEX_SHADER)},e.CompileFragmentShader=function(a,b){return e._CompileShader(a,b,a.FRAGMENT_SHADER)},e._CompileShader=function(a,b,c){var d=b.join("\n"),e=a.createShader(c);return a.shaderSource(e,d),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(alert(a.getShaderInfoLog(e)),null)},e._defaultFrame=new e.Rectangle(0,0,1,1),e.gl,e.WebGLRenderer=function(a,b,c,d){this.transparent=!!d,this.width=a||800,this.height=b||600,this.clearView=!0,this.view=c||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var f=this;this.view.addEventListener("webglcontextlost",function(a){f.handleContextLost(a)},!1),this.view.addEventListener("webglcontextrestored",function(a){f.handleContextRestored(a)},!1),this.batchs=[];try{e.gl=this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!1,premultipliedAlpha:!1})}catch(g){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}this.initShaders();var h=this.gl;e.WebGLRenderer.gl=h,this.batch=new e.WebGLBatch(h),h.disable(h.DEPTH_TEST),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.colorMask(!0,!0,!0,this.transparent),this.projectionMatrix=e.mat4.create(),this.resize(this.width,this.height),this.contextLost=!1,this.stageRenderGroup=new e.WebGLRenderGroup(this.gl)},e.WebGLRenderer.constructor=e.WebGLRenderer,e.WebGLRenderer.getBatch=function(){return 0==e._batchs.length?new e.WebGLBatch(e.WebGLRenderer.gl):e._batchs.pop()},e.WebGLRenderer.returnBatch=function(a){a.clean(),e._batchs.push(a)},e.WebGLRenderer.prototype.initShaders=function(){var a=this.gl,b=e.CompileFragmentShader(a,e.shaderFragmentSrc),c=e.CompileVertexShader(a,e.shaderVertexSrc);e.shaderProgram=a.createProgram();var d=e.shaderProgram;a.attachShader(d,c),a.attachShader(d,b),a.linkProgram(d),a.getProgramParameter(d,a.LINK_STATUS)||alert("Could not initialise shaders"),a.useProgram(d),d.vertexPositionAttribute=a.getAttribLocation(d,"aVertexPosition"),a.enableVertexAttribArray(d.vertexPositionAttribute),d.textureCoordAttribute=a.getAttribLocation(d,"aTextureCoord"),a.enableVertexAttribArray(d.textureCoordAttribute),d.colorAttribute=a.getAttribLocation(d,"aColor"),a.enableVertexAttribArray(d.colorAttribute),d.mvMatrixUniform=a.getUniformLocation(d,"uMVMatrix"),d.samplerUniform=a.getUniformLocation(d,"uSampler")},e.WebGLRenderer.prototype.render=function(a){if(!this.contextLost){this.__stage!==a&&(this.__stage=a,this.stageRenderGroup.setRenderable(a)),e.WebGLRenderer.updateTextures(),a.updateTransform();var b=this.gl;if(b.colorMask(!0,!0,!0,this.transparent),b.viewport(0,0,this.width,this.height),b.bindFramebuffer(b.FRAMEBUFFER,null),this.clearView){var c=a.backgroundColorSplit;b.clearColor(c[0],c[1],c[2],!this.transparent),b.clear(b.COLOR_BUFFER_BIT)}this.stageRenderGroup.backgroundColor=a.backgroundColorSplit,this.stageRenderGroup.render(this.projectionMatrix),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)));var d=e.Texture.frameUpdates.length;if(d>0){for(var f=e.Texture.frameUpdates,g=0;d>g;g++)f[g].updateFrame=!1;e.Texture.frameUpdates=[]}}},e.WebGLRenderer.updateTextures=function(){for(var a=e.texturesToUpdate,b=a.length,c=0;b>c;c++)this.updateTexture(a[c]);a=e.texturesToDestroy,b=a.length;for(var c=0;b>c;c++)this.destroyTexture(a[c]);e.texturesToUpdate=[],e.texturesToDestroy=[]},e.WebGLRenderer.updateTexture=function(a){var b=e.gl;a._glTexture||(a._glTexture=b.createTexture()),a.hasLoaded&&(b.bindTexture(b.TEXTURE_2D,a._glTexture),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),b.bindTexture(b.TEXTURE_2D,null))},e.WebGLRenderer.prototype.destroyTexture=function(a){var b=this.gl;a._glTexture&&(a._glTexture=b.createTexture(),b.deleteTexture(b.TEXTURE_2D,a._glTexture))},e.WebGLRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b,this.gl.viewport(0,0,this.width,this.height);var c=this.projectionMatrix;c[0]=2/this.width,c[5]=-2/this.height,c[12]=-1,c[13]=1},e.WebGLRenderer.prototype.handleContextLost=function(a){a.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(var a=e.TextureCache,b=a.length,c=0;b>c;c++)this.updateTexture(a[c]);a=this.batches,b=a.length;for(var c=0;b>c;c++){var d=a[c];d.restoreLostContext(this.gl),d.dirty=!0}e._restoreBatchs(this.gl),this.contextLost=!1},e._batchs=[],e._getBatch=function(a){return 0==e._batchs.length?new e.WebGLBatch(a):e._batchs.pop()},e._returnBatch=function(a){a.clean(),e._batchs.push(a)},e._restoreBatchs=function(a){for(var b=0;b<e._batchs.length;b++)e._batchs[b].restoreLostContext(a)},e.WebGLBatch=function(a){this.gl=a,this.size=0,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer(),this.blendMode=e.blendModes.NORMAL,this.dynamicSize=1},e.WebGLBatch.constructor=e.WebGLBatch,e.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},e.WebGLBatch.prototype.restoreLostContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer()},e.WebGLBatch.prototype.init=function(a){a.batch=this,this.dirty=!0,this.blendMode=a.blendMode,this.texture=a.texture.baseTexture,this.head=a,this.tail=a,this.size=1,this.growBatch()},e.WebGLBatch.prototype.insertBefore=function(a,b){this.size++,a.batch=this,this.dirty=!0;var c=b.__prev;b.__prev=a,a.__next=b,c?(a.__prev=c,c.__next=a):this.head=a},e.WebGLBatch.prototype.insertAfter=function(a,b){this.size++,a.batch=this,this.dirty=!0;var c=b.__next;b.__next=a,a.__prev=b,c?(a.__next=c,c.__prev=a):this.tail=a},e.WebGLBatch.prototype.remove=function(a){return this.size--,0==this.size?(a.batch=null,a.__prev=null,a.__next=null,void 0):(a.__prev?a.__prev.__next=a.__next:(this.head=a.__next,this.head.__prev=null),a.__next?a.__next.__prev=a.__prev:(this.tail=a.__prev,this.tail.__next=null),a.batch=null,a.__next=null,a.__prev=null,this.dirty=!0,void 0)},e.WebGLBatch.prototype.split=function(a){this.dirty=!0;
var b=new e.WebGLBatch(this.gl);b.init(a),b.texture=this.texture,b.tail=this.tail,this.tail=a.__prev,this.tail.__next=null,a.__prev=null;for(var c=0;a;)c++,a.batch=b,a=a.__next;return b.size=c,this.size-=c,b},e.WebGLBatch.prototype.merge=function(a){this.dirty=!0,this.tail.__next=a.head,a.head.__prev=this.tail,this.size+=a.size,this.tail=a.tail;for(var b=a.head;b;)b.batch=this,b=b.__next},e.WebGLBatch.prototype.growBatch=function(){var a=this.gl;this.dynamicSize=1==this.size?1:1.5*this.size,this.verticies=new Float32Array(8*this.dynamicSize),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.verticies,a.DYNAMIC_DRAW),this.uvs=new Float32Array(8*this.dynamicSize),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.bufferData(a.ARRAY_BUFFER,this.uvs,a.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(4*this.dynamicSize),a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer),a.bufferData(a.ARRAY_BUFFER,this.colors,a.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(6*this.dynamicSize);for(var b=this.indices.length/6,c=0;b>c;c++){var d=6*c,e=4*c;this.indices[d+0]=e+0,this.indices[d+1]=e+1,this.indices[d+2]=e+2,this.indices[d+3]=e+0,this.indices[d+4]=e+2,this.indices[d+5]=e+3}a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW)},e.WebGLBatch.prototype.refresh=function(){this.gl,this.dynamicSize<this.size&&this.growBatch();for(var a,b=0,c=this.head;c;){a=8*b;var d=c.texture,e=d.frame,f=d.baseTexture.width,g=d.baseTexture.height;this.uvs[a+0]=e.x/f,this.uvs[a+1]=e.y/g,this.uvs[a+2]=(e.x+e.width)/f,this.uvs[a+3]=e.y/g,this.uvs[a+4]=(e.x+e.width)/f,this.uvs[a+5]=(e.y+e.height)/g,this.uvs[a+6]=e.x/f,this.uvs[a+7]=(e.y+e.height)/g,c.updateFrame=!1,colorIndex=4*b,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=c.worldAlpha,c=c.__next,b++}this.dirtyUVS=!0,this.dirtyColors=!0},e.WebGLBatch.prototype.update=function(){this.gl;for(var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=0,r=this.head;r;){if(r.worldVisible){b=r.texture.frame.width,c=r.texture.frame.height,d=r.anchor.x,e=r.anchor.y,f=b*(1-d),g=b*-d,h=c*(1-e),i=c*-e,j=8*q,a=r.worldTransform,k=a[0],l=a[3],m=a[1],n=a[4],o=a[2],p=a[5];var s=this.verticies;if(s[j+0]=k*g+m*i+o,s[j+1]=n*i+l*g+p,s[j+2]=k*f+m*i+o,s[j+3]=n*i+l*f+p,s[j+4]=k*f+m*h+o,s[j+5]=n*h+l*f+p,s[j+6]=k*g+m*h+o,s[j+7]=n*h+l*g+p,r.updateFrame||r.texture.updateFrame){this.dirtyUVS=!0;var t=r.texture,u=t.frame,v=t.baseTexture.width,w=t.baseTexture.height,x=this.uvs,y=x[j+0]=u.x/v,z=x[j+1]=u.y/w,A=x[j+2]=(u.x+u.width)/v;x[j+3]=z,x[j+4]=A;var B=x[j+5]=(u.y+u.height)/w;x[j+6]=y,x[j+7]=B,r.updateFrame=!1}if(r.cacheAlpha!=r.worldAlpha){r.cacheAlpha=r.worldAlpha;var C=4*q;this.colors[C]=this.colors[C+1]=this.colors[C+2]=this.colors[C+3]=r.worldAlpha,this.dirtyColors=!0}}else{j=8*q;var D=this.verticies;D[j+0]=0,D[j+1]=0,D[j+2]=0,D[j+3]=0,D[j+4]=0,D[j+5]=0,D[j+6]=0,D[j+7]=0}q++,r=r.__next}},e.WebGLBatch.prototype.render=function(a,b){if(a=a||0,void 0==b&&(b=this.size),this.dirty&&(this.refresh(),this.dirty=!1),0!=this.size){this.update();var c=this.gl,d=c.ARRAY_BUFFER,f=c.FLOAT;c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA);var g=e.shaderProgram;c.useProgram(g),c.bindBuffer(d,this.vertexBuffer),c.bufferSubData(d,0,this.verticies),c.vertexAttribPointer(g.vertexPositionAttribute,2,f,!1,0,0),c.bindBuffer(d,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,c.bufferSubData(d,0,this.uvs)),c.vertexAttribPointer(g.textureCoordAttribute,2,f,!1,0,0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.texture._glTexture),c.bindBuffer(d,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,c.bufferSubData(d,0,this.colors)),c.vertexAttribPointer(g.colorAttribute,1,f,!1,0,0),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var h=b-a;c.drawElements(c.TRIANGLES,6*h,c.UNSIGNED_SHORT,6*2*a)}},e.WebGLRenderGroup=function(a){this.gl=a,this.root,this.backgroundColor,this.batchs=[],this.toRemove=[]},e.WebGLRenderGroup.constructor=e.WebGLRenderGroup,e.WebGLRenderGroup.prototype.setRenderable=function(a){this.root&&this.removeDisplayObjectAndChildren(this.root),a.worldVisible=a.visible,this.root=a,this.addDisplayObjectAndChildren(a)},e.WebGLRenderGroup.prototype.render=function(a){e.WebGLRenderer.updateTextures();var b=this.gl;b.uniformMatrix4fv(e.shaderProgram.mvMatrixUniform,!1,a),this.checkVisibility(this.root,this.root.visible);for(var c,d=this.batchs,f=d.length,g=0;f>g;g++)c=d[g],c instanceof e.WebGLBatch?c.render():c instanceof e.TilingSprite?c.visible&&this.renderTilingSprite(c,a):c instanceof e.Strip&&c.visible&&this.renderStrip(c,a)},e.WebGLRenderGroup.prototype.renderSpecific=function(a,b){e.WebGLRenderer.updateTextures();var c=this.gl;this.checkVisibility(a,a.visible),c.uniformMatrix4fv(e.shaderProgram.mvMatrixUniform,!1,b);var d,f,g,h,i=a.renderable?a:this.getNextRenderable(a),j=i.batch;if(i instanceof e.Sprite){j=i.batch;var k=j.head;if(k==i)d=0;else for(d=1;k.__next!=i;)d++,k=k.__next}else j=i;for(var l,m=a,n=a;n.children.length>0;)n=n.children[n.children.length-1],n.renderable&&(m=n);if(m instanceof e.Sprite){l=m.batch;var k=l.head;if(k==m)g=0;else for(g=1;k.__next!=m;)g++,k=k.__next}else l=m;if(j==l)return j instanceof e.WebGLBatch?j.render(d,g+1):j instanceof e.TilingSprite?j.visible&&this.renderTilingSprite(j,b):j instanceof e.Strip?j.visible&&this.renderStrip(j,b):j instanceof e.CustomRenderable&&j.visible&&j.renderWebGL(this,b),void 0;f=this.batchs.indexOf(j),h=this.batchs.indexOf(l),j instanceof e.WebGLBatch?j.render(d):j instanceof e.TilingSprite?j.visible&&this.renderTilingSprite(j,b):j instanceof e.Strip?j.visible&&this.renderStrip(j,b):j instanceof e.CustomRenderable&&j.visible&&j.renderWebGL(this,b);for(var o=f+1;h>o;o++)renderable=this.batchs[o],renderable instanceof e.WebGLBatch?this.batchs[o].render():renderable instanceof e.TilingSprite?renderable.visible&&this.renderTilingSprite(renderable,b):renderable instanceof e.Strip?renderable.visible&&this.renderStrip(renderable,b):renderable instanceof e.CustomRenderable&&renderable.visible&&renderable.renderWebGL(this,b);l instanceof e.WebGLBatch?l.render(0,g+1):l instanceof e.TilingSprite?l.visible&&this.renderTilingSprite(l):l instanceof e.Strip?l.visible&&this.renderStrip(l):l instanceof e.CustomRenderable&&l.visible&&l.renderWebGL(this,b)},e.WebGLRenderGroup.prototype.checkVisibility=function(a,b){for(var c=a.children,d=0,e=c.length;e>d;d++){var f=c[d];f.worldVisible=f.visible&&b,f.textureChange&&(f.textureChange=!1,f.worldVisible&&(this.removeDisplayObject(f),this.addDisplayObject(f))),f.children.length>0&&this.checkVisibility(f,f.worldVisible)}},e.WebGLRenderGroup.prototype.updateTexture=function(a){if(1==a.batch.length)return a.batch.texture=a.texture.baseTexture,void 0;if(a.batch.texture!=a.texture.baseTexture)if(a.batch.head==a){var b=a.batch,c=this.batchs.indexOf(b),d=this.batchs[c-1];if(b.remove(a),d)if(d.texture==a.texture.baseTexture&&d.blendMode==a.blendMode)d.insertAfter(a,d.tail);else{var f=e.WebGLRenderer.getBatch();f.init(a),this.batchs.splice(c-1,0,f)}else{var f=e.WebGLRenderer.getBatch();f.init(a),this.batchs.splice(0,0,f)}}else if(a.batch.tail==a){var b=a.batch,c=this.batchs.indexOf(b),g=this.batchs[c+1];if(b.remove(a),g){if(g.texture==a.texture.baseTexture&&g.blendMode==a.blendMode)return g.insertBefore(a,g.head),void 0;var f=e.WebGLRenderer.getBatch();f.init(a),this.batchs.splice(c+1,0,f)}else{var f=e.WebGLRenderer.getBatch();f.init(a),this.batchs.push(f)}}else{var b=a.batch,h=b.split(a);h.remove(a);var f=e.WebGLRenderer.getBatch(),c=this.batchs.indexOf(b);f.init(a),this.batchs.splice(c+1,0,f,h)}},e.WebGLRenderGroup.prototype.addDisplayObject=function(a){if(a.__renderGroup&&a.__renderGroup.removeDisplayObjectAndChildren(a),a.__renderGroup=this,a.renderable){var b=this.getPreviousRenderable(a),c=this.getNextRenderable(a);if(a instanceof e.Sprite){var d,f;if(b instanceof e.Sprite){if(d=b.batch,d&&d.texture==a.texture.baseTexture&&d.blendMode==a.blendMode)return d.insertAfter(a,b),void 0}else d=b;if(c)if(c instanceof e.Sprite){if(f=c.batch){if(f.texture==a.texture.baseTexture&&f.blendMode==a.blendMode)return f.insertBefore(a,c),void 0;if(f==d){var g=d.split(c),h=e.WebGLRenderer.getBatch(),i=this.batchs.indexOf(d);return h.init(a),this.batchs.splice(i+1,0,h,g),void 0}}}else f=c;var h=e.WebGLRenderer.getBatch();if(h.init(a),d){var i=this.batchs.indexOf(d);this.batchs.splice(i+1,0,h)}else this.batchs.push(h)}else a instanceof e.TilingSprite?(this.initTilingSprite(a),this.batchs.push(a)):a instanceof e.Strip&&(this.initStrip(a),this.batchs.push(a));this.batchUpdate=!0}},e.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(a){this.addDisplayObject(a);for(var b=a.children,c=0;c<b.length;c++)this.addDisplayObjectAndChildren(b[c])},e.WebGLRenderGroup.prototype.removeDisplayObject=function(a){if(a.__renderGroup=null,a.renderable){var b;if(a instanceof e.Sprite){var c=a.batch;if(!c)return;c.remove(a),0==c.size&&(b=c)}else b=a;if(b){var d=this.batchs.indexOf(b);if(-1==d)return;if(0==d||d==this.batchs.length-1)return this.batchs.splice(d,1),b instanceof e.WebGLBatch&&e.WebGLRenderer.returnBatch(b),void 0;if(this.batchs[d-1]instanceof e.WebGLBatch&&this.batchs[d+1]instanceof e.WebGLBatch&&this.batchs[d-1].texture==this.batchs[d+1].texture&&this.batchs[d-1].blendMode==this.batchs[d+1].blendMode)return this.batchs[d-1].merge(this.batchs[d+1]),b instanceof e.WebGLBatch&&e.WebGLRenderer.returnBatch(b),e.WebGLRenderer.returnBatch(this.batchs[d+1]),this.batchs.splice(d,2),void 0;this.batchs.splice(d,1),b instanceof e.WebGLBatch&&e.WebGLRenderer.returnBatch(b)}}},e.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(a){if(a.__renderGroup==this){this.removeDisplayObject(a);for(var b=a.children,c=0;c<b.length;c++)this.removeDisplayObjectAndChildren(b[c])}},e.WebGLRenderGroup.prototype.getNextRenderable=function(a){var b=a;do{if(0==b.children.length){if(!b.parent)return null;for(;b.childIndex==b.parent.children.length-1;)if(b=b.parent,b==this.root||!b.parent){b=null;break}b&&(b=b.parent.children[b.childIndex+1])}else b=b.children[0];if(!b)break}while(!b.renderable||!b.__renderGroup);return b},e.WebGLRenderGroup.prototype.getPreviousRenderable=function(a){var b=a;do{if(0==b.childIndex){if(b=b.parent,!b)return null}else for(b=b.parent.children[b.childIndex-1];0!=b.children.length;)b=b.children[b.children.length-1];if(b==this.root)break}while(!b.renderable||!b.__renderGroup);return b},e.WebGLRenderGroup.prototype.initTilingSprite=function(a){var b=this.gl;a.verticies=new Float32Array([0,0,a.width,0,a.width,a.height,0,a.height]),a.uvs=new Float32Array([0,0,1,0,1,1,0,1]),a.colors=new Float32Array([1,1,1,1]),a.indices=new Uint16Array([0,1,3,2]),a._vertexBuffer=b.createBuffer(),a._indexBuffer=b.createBuffer(),a._uvBuffer=b.createBuffer(),a._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,a._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,a.verticies,b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._uvBuffer),b.bufferData(b.ARRAY_BUFFER,a.uvs,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._colorBuffer),b.bufferData(b.ARRAY_BUFFER,a.colors,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.indices,b.STATIC_DRAW),a.texture.baseTexture._glTexture?(b.bindTexture(b.TEXTURE_2D,a.texture.baseTexture._glTexture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),a.texture.baseTexture._powerOf2=!0):a.texture.baseTexture._powerOf2=!0},e.WebGLRenderGroup.prototype.renderStrip=function(a,b){var c=this.gl,d=e.shaderProgram,f=e.mat3.toMat4(a.worldTransform);e.mat4.transpose(f),e.mat4.multiply(b,f,f),c.uniformMatrix4fv(d.mvMatrixUniform,!1,f),a.blendMode==e.blendModes.NORMAL?c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA):c.blendFunc(c.ONE,c.ONE_MINUS_SRC_COLOR),a.dirty?(a.dirty=!1,c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferData(c.ARRAY_BUFFER,a.verticies,c.STATIC_DRAW),c.vertexAttribPointer(d.vertexPositionAttribute,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.bufferData(c.ARRAY_BUFFER,a.uvs,c.STATIC_DRAW),c.vertexAttribPointer(d.textureCoordAttribute,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,a.texture.baseTexture._glTexture),c.bindBuffer(c.ARRAY_BUFFER,a._colorBuffer),c.bufferData(c.ARRAY_BUFFER,a.colors,c.STATIC_DRAW),c.vertexAttribPointer(d.colorAttribute,1,c.FLOAT,!1,0,0),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a._indexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,a.indices,c.STATIC_DRAW)):(c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,a.verticies),c.vertexAttribPointer(d.vertexPositionAttribute,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.vertexAttribPointer(d.textureCoordAttribute,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,a.texture.baseTexture._glTexture),c.bindBuffer(c.ARRAY_BUFFER,a._colorBuffer),c.vertexAttribPointer(d.colorAttribute,1,c.FLOAT,!1,0,0),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a._indexBuffer)),c.drawElements(c.TRIANGLE_STRIP,a.indices.length,c.UNSIGNED_SHORT,0),c.uniformMatrix4fv(d.mvMatrixUniform,!1,b)},e.WebGLRenderGroup.prototype.renderTilingSprite=function(a,b){var c=this.gl;e.shaderProgram;var d=a.tilePosition,f=a.tileScale,g=d.x/a.texture.baseTexture.width,h=d.y/a.texture.baseTexture.height,i=a.width/a.texture.baseTexture.width/f.x,j=a.height/a.texture.baseTexture.height/f.y;a.uvs[0]=0-g,a.uvs[1]=0-h,a.uvs[2]=1*i-g,a.uvs[3]=0-h,a.uvs[4]=1*i-g,a.uvs[5]=1*j-h,a.uvs[6]=0-g,a.uvs[7]=1*j-h,c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,a.uvs),this.renderStrip(a,b)},e.WebGLRenderer.prototype.initStrip=function(a){var b=this.gl;this.shaderProgram,a._vertexBuffer=b.createBuffer(),a._indexBuffer=b.createBuffer(),a._uvBuffer=b.createBuffer(),a._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,a._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,a.verticies,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._uvBuffer),b.bufferData(b.ARRAY_BUFFER,a.uvs,b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._colorBuffer),b.bufferData(b.ARRAY_BUFFER,a.colors,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.indices,b.STATIC_DRAW)},e.CanvasRenderer=function(a,b,c,d){this.transparent=d,this.width=a||800,this.height=b||600,this.refresh=!0,this.clearView=!0,this.view=c||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.count=0,this.context=this.view.getContext("2d")},e.CanvasRenderer.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(a){e.texturesToUpdate=[],e.texturesToDestroy=[],a.updateTransform(),this.transparent||this.view.style.backgroundColor==a.backgroundColorString||(this.view.style.backgroundColor=a.backgroundColorString),this.context.setTransform(1,0,0,1,0,0),this.clearView&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(a),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates=[])},e.CanvasRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b},e.CanvasRenderer.prototype.renderDisplayObject=function(a){if(a.visible){var b=a.worldTransform,c=this.context;if(a instanceof e.Sprite){var d=a.texture.frame;if(d){c.globalAlpha=a.worldAlpha,c.setTransform(b[0],b[3],b[1],b[4],b[2],b[5]);var f=d.width,g=d.height;c.drawImage(a.texture.baseTexture.source,d.x,d.y,f,g,a.anchor.x*-f,a.anchor.y*-g,f,g)}}else a instanceof e.Strip?(c.setTransform(b[0],b[3],b[1],b[4],b[2],b[5]),this.renderStrip(a)):a instanceof e.TilingSprite?(c.setTransform(b[0],b[3],b[1],b[4],b[2],b[5]),this.renderTilingSprite(a)):a instanceof e.CustomRenderable&&a.renderCanvas(this);if(a.children)for(var h=a.children,i=0,j=h.length;j>i;i++)this.renderDisplayObject(h[i]);this.context.setTransform(1,0,0,1,0,0)}},e.CanvasRenderer.prototype.renderStripFlat=function(a){var b=this.context,c=a.verticies;a.uvs;var d=c.length/2;this.count++,b.beginPath();for(var e=1;d-2>e;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},e.CanvasRenderer.prototype.renderTilingSprite=function(a){var b=this.context;a.__tilePattern||(a.__tilePattern=b.createPattern(a.texture.baseTexture.source,"repeat")),b.beginPath();var c=a.tilePosition,d=a.tileScale;b.scale(d.x,d.y),b.translate(c.x,c.y),b.fillStyle=a.__tilePattern,b.fillRect(-c.x,-c.y,a.width/d.x,a.height/d.y),b.scale(1/d.x,1/d.y),b.translate(-c.x,-c.y),b.closePath()},e.CanvasRenderer.prototype.renderStrip=function(a){var b=this.context,c=a.verticies,d=a.uvs,e=c.length/2;this.count++;for(var f=1;e-2>f;f++){var g=2*f,h=c[g],i=c[g+2],j=c[g+4],k=c[g+1],l=c[g+3],m=c[g+5],n=d[g]*a.texture.width,o=d[g+2]*a.texture.width,p=d[g+4]*a.texture.width,q=d[g+1]*a.texture.height,r=d[g+3]*a.texture.height,s=d[g+5]*a.texture.height;b.save(),b.beginPath(),b.moveTo(h,k),b.lineTo(i,l),b.lineTo(j,m),b.closePath(),b.clip();var t=n*r+q*p+o*s-r*p-q*o-n*s,u=h*r+q*j+i*s-r*j-q*i-h*s,v=n*i+h*p+o*j-i*p-h*o-n*j,w=n*r*j+q*i*p+h*o*s-h*r*p-q*o*j-n*i*s,x=k*r+q*m+l*s-r*m-q*l-k*s,y=n*l+k*p+o*m-l*p-k*o-n*m,z=n*r*m+q*l*p+k*o*s-k*r*p-q*o*m-n*l*s;b.transform(u/t,x/t,v/t,y/t,w/t,z/t),b.drawImage(a.texture.baseTexture.source,0,0),b.restore()}},e.Strip=function(a,b,c){e.DisplayObjectContainer.call(this),this.texture=a,this.blendMode=e.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(d){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=b,this.height=c,a.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Strip.constructor=e.Strip,e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Strip.prototype.setTexture=function(a){this.texture=a,this.width=a.frame.width,this.height=a.frame.height,this.updateFrame=!0},e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(a,b){e.Strip.call(this,a),this.points=b;try{this.verticies=new Float32Array(4*b.length),this.uvs=new Float32Array(4*b.length),this.colors=new Float32Array(2*b.length),this.indices=new Uint16Array(2*b.length)}catch(c){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},e.Rope.constructor=e.Rope,e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=this.indices,d=this.colors,e=a[0],f=a[0];this.count-=.2,b[0]=0,b[1]=1,b[2]=0,b[3]=1,d[0]=1,d[1]=1,c[0]=0,c[1]=1;for(var g=a.length,h=1;g>h;h++){var f=a[h],i=4*h,j=h/(g-1);h%2?(b[i]=j,b[i+1]=0,b[i+2]=j,b[i+3]=1):(b[i]=j,b[i+1]=0,b[i+2]=j,b[i+3]=1),i=2*h,d[i]=1,d[i+1]=1,i=2*h,c[i]=i,c[i+1]=i+1,e=f}}},e.Rope.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){var b,c=this.verticies,d=a[0],f={x:0,y:0},g=a[0];this.count-=.2,c[0]=g.x+f.x,c[1]=g.y+f.y,c[2]=g.x-f.x,c[3]=g.y-f.y;for(var h=a.length,i=1;h>i;i++){var g=a[i],j=4*i;b=i<a.length-1?a[i+1]:g,f.y=-(b.x-d.x),f.x=b.y-d.y;var k=10*(1-i/(h-1));k>1&&(k=1);var l=Math.sqrt(f.x*f.x+f.y*f.y),m=this.texture.height/2;f.x/=l,f.y/=l,f.x*=m,f.y*=m,c[j]=g.x+f.x,c[j+1]=g.y+f.y,c[j+2]=g.x-f.x,c[j+3]=g.y-f.y,d=g}e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(a){this.texture=a,this.updateFrame=!0},e.TilingSprite=function(a,b,c){e.DisplayObjectContainer.call(this),this.texture=a,this.width=b,this.height=c,this.renderable=!0,this.tileScale=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.blendMode=e.blendModes.NORMAL},e.TilingSprite.constructor=e.TilingSprite,e.TilingSprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.TilingSprite.prototype.setTexture=function(a){this.texture=a,this.updateFrame=!0},e.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Spine=function(a){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[b(a)],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+a);this.count=0,this.sprites=[],this.skeleton=new j.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new j.AnimationStateData(this.spineData),this.state=new j.AnimationState(this.stateData);for(var c=0;c<this.skeleton.drawOrder.length;c++){var d=this.skeleton.drawOrder[c].data.attachmentName;e.TextureCache[d]||(d+=".png");var f=new e.Sprite(e.Texture.fromFrame(d));f.anchor.x=f.anchor.y=.5,this.addChild(f),this.sprites.push(f)}},e.Spine.constructor=e.Spine,e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.updateAnim=function(a){this.state.update(a),this.state.apply(this.skeleton)},e.Spine.prototype.updateTransform=function(){this.skeleton.updateWorldTransform();for(var a=0,b=this.skeleton.drawOrder.length;b>a;a++){var c=this.skeleton.drawOrder[a],d=this.sprites[a],f=c.bone,g=c.attachment,h=f.worldX+g.x*f.m00+g.y*f.m01+.5*g.width,i=f.worldY+g.x*f.m10+g.y*f.m11+.5*g.height;if(c.cacheName!=g.name){var j=g.name;e.TextureCache[j]||(j+=".png"),d.setTexture(e.TextureCache[j]),c.cacheName=g.name}h+=-(g.width*(f.worldScaleX+g.scaleX-1)>>1),i+=-(g.height*(f.worldScaleY+g.scaleY-1)>>1),d.alpha=c.a,d.position.x=h,d.position.y=i,d.rotation=-(f.worldRotation+g.rotation)*Math.PI_OVER_180}e.DisplayObjectContainer.prototype.updateTransform.call(this)};var j={};j.BoneData=function(a,b){this.name=a,this.parent=b},j.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},j.SlotData=function(a,b){this.name=a,this.boneData=b},j.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},j.Bone=function(a,b){this.data=a,this.parent=b,this.setToSetupPose()},j.Bone.yDown=!1,j.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(a,b){var c=this.parent;null!=c?(this.worldX=this.x*c.m00+this.y*c.m01+c.worldX,this.worldY=this.x*c.m10+this.y*c.m11+c.worldY,this.worldScaleX=c.worldScaleX*this.scaleX,this.worldScaleY=c.worldScaleY*this.scaleY,this.worldRotation=c.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var d=this.worldRotation*Math.PI/180,e=Math.cos(d),f=Math.sin(d);this.m00=e*this.worldScaleX,this.m10=f*this.worldScaleX,this.m01=-f*this.worldScaleY,this.m11=e*this.worldScaleY,a&&(this.m00=-this.m00,this.m01=-this.m01),b&&(this.m10=-this.m10,this.m11=-this.m11),j.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY}},j.Slot=function(a,b,c){this.data=a,this.skeleton=b,this.bone=c,this.setToSetupPose()},j.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(a){this.attachment=a,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(a){this._attachmentTime=this.skeleton.time-a},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},j.Skin=function(a){this.name=a,this.attachments={}},j.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d)),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},j.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},j.Animation.prototype={apply:function(a,b,c){c&&0!=this.duration&&(b%=this.duration);for(var d=this.timelines,e=0,f=d.length;f>e;e++)d[e].apply(a,b,1)},mix:function(a,b,c,d){c&&0!=this.duration&&(b%=this.duration);for(var e=this.timelines,f=0,g=e.length;g>f;f++)e[f].apply(a,b,d)}},j.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(0==e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},j.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},j.Curves=function(a){this.curves=[],this.curves.length=6*(a-1)},j.Curves.prototype={setLinear:function(a){this.curves[6*a]=0},setStepped:function(a){this.curves[6*a]=-1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=6*a,r=this.curves;r[q]=b*i+m*j+o*h,r[q+1]=c*i+n*j+p*h,r[q+2]=m*k+o*l,r[q+3]=n*k+p*l,r[q+4]=o*l,r[q+5]=p*l},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=6*a,d=this.curves,e=d[c];if(!e)return b;if(-1==e)return 0;for(var f=d[c+1],g=d[c+2],h=d[c+3],i=d[c+4],j=d[c+5],k=e,l=f,m=8;;){if(k>=b){var n=k-e,o=l-f;return o+(l-o)*(b-n)/(k-n)}if(0==m)break;m--,e+=g,f+=h,g+=i,h+=j,k+=e,l+=f}return l+(1-l)*(b-k)/(1-k)}},j.RotateTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=2*a},j.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-2]){for(var f=e.data.rotation+d[d.length-1]-e.rotation;f>180;)f-=360;for(;-180>f;)f+=360;return e.rotation+=f*c,void 0}var g=j.binarySearch(d,b,2),h=d[g-1],i=d[g],k=1-(b-i)/(d[g-2]-i);k=this.curves.getCurvePercent(g/2-1,k);for(var f=d[g+1]-h;f>180;)f-=360;for(;-180>f;)f+=360;for(f=e.data.rotation+(h+f*k)-e.rotation;f>180;)f-=360;for(;-180>f;)f+=360;e.rotation+=f*c}}},j.TranslateTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=3*a},j.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.x+=(e.data.x+d[d.length-2]-e.x)*c,e.y+=(e.data.y+d[d.length-1]-e.y)*c,void 0;var f=j.binarySearch(d,b,3),g=d[f-2],h=d[f-1],i=d[f],k=1-(b-i)/(d[f+-3]-i);k=this.curves.getCurvePercent(f/3-1,k),e.x+=(e.data.x+g+(d[f+1]-g)*k-e.x)*c,e.y+=(e.data.y+h+(d[f+2]-h)*k-e.y)*c}}},j.ScaleTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=3*a},j.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.scaleX+=(e.data.scaleX-1+d[d.length-2]-e.scaleX)*c,e.scaleY+=(e.data.scaleY-1+d[d.length-1]-e.scaleY)*c,void 0;var f=j.binarySearch(d,b,3),g=d[f-2],h=d[f-1],i=d[f],k=1-(b-i)/(d[f+-3]-i);k=this.curves.getCurvePercent(f/3-1,k),e.scaleX+=(e.data.scaleX-1+g+(d[f+1]-g)*k-e.scaleX)*c,e.scaleY+=(e.data.scaleY-1+h+(d[f+2]-h)*k-e.scaleY)*c}}},j.ColorTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=5*a},j.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,c,d,e,f){a*=5,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d,this.frames[a+3]=e,this.frames[a+4]=f},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.slots[this.slotIndex];if(b>=d[d.length-5]){var f=d.length-1;return e.r=d[f-3],e.g=d[f-2],e.b=d[f-1],e.a=d[f],void 0}var g=j.binarySearch(d,b,5),h=d[g-4],i=d[g-3],k=d[g-2],l=d[g-1],m=d[g],n=1-(b-m)/(d[g-5]-m);n=this.curves.getCurvePercent(g/5-1,n);var o=h+(d[g+1]-h)*n,p=i+(d[g+2]-i)*n,q=k+(d[g+3]-k)*n,r=l+(d[g+4]-l)*n;1>c?(e.r+=(o-e.r)*c,e.g+=(p-e.g)*c,e.b+=(q-e.b)*c,e.a+=(r-e.a)*c):(e.r=o,e.g=p,e.b=q,e.a=r)}}},j.AttachmentTimeline=function(a){this.curves=new j.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},j.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b){var c=this.frames;if(!(b<c[0])){var d;d=b>=c[c.length-1]?c.length-1:j.binarySearch(c,b,1)-1;var e=this.attachmentNames[d];a.slots[this.slotIndex].setAttachment(e?a.getAttachmentBySlotIndex(this.slotIndex,e):null)}}},j.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},j.SkeletonData.prototype={defaultSkin:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},j.Skeleton=function(a){this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],e=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new j.Bone(d,e))}this.slots=[],this.drawOrder=[];for(var b=0,c=a.slots.length;c>b;b++){var f=a.slots[b],g=this.bones[a.bones.indexOf(f.boneData)],h=new j.Slot(f,this,g);this.slots.push(h),this.drawOrder.push(h)}},j.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var a=this.flipX,b=this.flipY,c=this.bones,d=0,e=c.length;e>d;d++)c[d].updateWorldTransform(a,b)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose()},setSlotsToSetupPose:function(){for(var a=this.slots,b=0,c=a.length;c>b;b++)a[b].setToSetupPose(b)},getRootBone:function(){return 0==this.bones.length?null:this.bones[0]},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){this.skin&&a&&a._attachAll(this,this.skin),this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.size;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachment(d,b),null==g))throw"Attachment not found: "+b+", for slot: "+a;return f.setAttachment(g),void 0}}throw"Slot not found: "+a},update:function(a){time+=a
}},j.AttachmentType={region:0},j.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},j.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,e=c+this.regionWidth*a,f=d+this.regionHeight*b,g=this.rotation*Math.PI/180,h=Math.cos(g),i=Math.sin(g),j=c*h+this.x,k=c*i,l=d*h+this.y,m=d*i,n=e*h+this.x,o=e*i,p=f*h+this.y,q=f*i,r=this.offset;r[0]=j-m,r[1]=l+k,r[2]=j-q,r[3]=p+k,r[4]=n-q,r[5]=p+o,r[6]=n-m,r[7]=l+o},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},j.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={}},j.AnimationStateData.prototype={setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=this.animationToMixTime[a.name+":"+b.name];return c?c:0}},j.AnimationState=function(a){this.data=a,this.queue=[]},j.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(a){if(this.currentTime+=a,this.previousTime+=a,this.mixTime+=a,this.queue.length>0){var b=this.queue[0];this.currentTime>=b.delay&&(this._setAnimation(b.animation,b.loop),this.queue.shift())}},apply:function(a){if(this.current)if(this.previous){this.previous.apply(a,this.previousTime,this.previousLoop);var b=this.mixTime/this.mixDuration;b>=1&&(b=1,this.previous=null),this.current.mix(a,this.currentTime,this.currentLoop,b)}else this.current.apply(a,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(a,b){this.previous=null,a&&this.current&&(this.mixDuration=this.data.getMix(this.current,a),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=a,this.currentLoop=b,this.currentTime=0},setAnimationByName:function(a,b){var c=this.data.skeletonData.findAnimation(a);if(!c)throw"Animation not found: "+a;this.setAnimation(c,b)},setAnimation:function(a,b){this.queue.length=0,this._setAnimation(a,b)},addAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;this.addAnimation(d,b,c)},addAnimation:function(a,b,c){var d={};if(d.animation=a,d.loop=b,!c||0>=c){var e=0==this.queue.length?this.current:this.queue[this.queue.length-1].animation;c=null!=e?e.duration-this.data.getMix(e,a)+(c||0):0}d.delay=c,this.queue.push(d)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},j.SkeletonJson=function(a){this.attachmentLoader=a},j.SkeletonJson.prototype={scale:1,readSkeletonData:function(a){for(var b=new j.SkeletonData,c=a.bones,d=0,e=c.length;e>d;d++){var f=c[d],g=null;if(f.parent&&(g=b.findBone(f.parent),!g))throw"Parent bone not found: "+f.parent;var h=new j.BoneData(f.name,g);h.length=(f.length||0)*this.scale,h.x=(f.x||0)*this.scale,h.y=(f.y||0)*this.scale,h.rotation=f.rotation||0,h.scaleX=f.scaleX||1,h.scaleY=f.scaleY||1,b.bones.push(h)}for(var i=a.slots,d=0,e=i.length;e>d;d++){var k=i[d],h=b.findBone(k.bone);if(!h)throw"Slot bone not found: "+k.bone;var l=new j.SlotData(k.name,h),m=k.color;m&&(l.r=j.SkeletonJson.toColor(m,0),l.g=j.SkeletonJson.toColor(m,1),l.b=j.SkeletonJson.toColor(m,2),l.a=j.SkeletonJson.toColor(m,3)),l.attachmentName=k.attachment,b.slots.push(l)}var n=a.skins;for(var o in n)if(n.hasOwnProperty(o)){var p=n[o],q=new j.Skin(o);for(var r in p)if(p.hasOwnProperty(r)){var s=b.findSlotIndex(r),t=p[r];for(var u in t)if(t.hasOwnProperty(u)){var v=this.readAttachment(q,u,t[u]);null!=v&&q.addAttachment(s,u,v)}}b.skins.push(q),"default"==q.name&&(b.defaultSkin=q)}var w=a.animations;for(var x in w)w.hasOwnProperty(x)&&this.readAnimation(x,w[x],b);return b},readAttachment:function(a,b,c){b=c.name||b;var d=j.AttachmentType[c.type||"region"],e=new j.RegionAttachment;return e.name=b,d==j.AttachmentType.region&&(e.x=(c.x||0)*this.scale,e.y=(c.y||0)*this.scale,e.scaleX=c.scaleX||1,e.scaleY=c.scaleY||1,e.rotation=c.rotation||0,e.width=(c.width||32)*this.scale,e.height=(c.height||32)*this.scale,e.updateOffset()),e},readAnimation:function(a,b,c){var d=[],e=0,f=b.bones;for(var g in f)if(f.hasOwnProperty(g)){var h=c.findBoneIndex(g);if(-1==h)throw"Bone not found: "+g;var i=f[g];for(var k in i)if(i.hasOwnProperty(k)){var l=i[k];if("rotate"==k){var m=new j.RotateTimeline(l.length);m.boneIndex=h;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n,q.time,q.angle),j.SkeletonJson.readCurve(m,n,q),n++}d.push(m),e=Math.max(e,m.frames[2*m.getFrameCount()-2])}else{if("translate"!=k&&"scale"!=k)throw"Invalid timeline type for a bone: "+k+" ("+g+")";var m,r=1;"scale"==k?m=new j.ScaleTimeline(l.length):(m=new j.TranslateTimeline(l.length),r=this.scale),m.boneIndex=h;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],s=(q.x||0)*r,t=(q.y||0)*r;m.setFrame(n,q.time,s,t),j.SkeletonJson.readCurve(m,n,q),n++}d.push(m),e=Math.max(e,m.frames[3*m.getFrameCount()-3])}}}var u=b.slots;for(var v in u)if(u.hasOwnProperty(v)){var w=u[v],x=c.findSlotIndex(v);for(var k in w)if(w.hasOwnProperty(k)){var l=w[k];if("color"==k){var m=new j.ColorTimeline(l.length);m.slotIndex=x;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],y=q.color,z=j.SkeletonJson.toColor(y,0),A=j.SkeletonJson.toColor(y,1),B=j.SkeletonJson.toColor(y,2),C=j.SkeletonJson.toColor(y,3);m.setFrame(n,q.time,z,A,B,C),j.SkeletonJson.readCurve(m,n,q),n++}d.push(m),e=Math.max(e,m.frames[5*m.getFrameCount()-5])}else{if("attachment"!=k)throw"Invalid timeline type for a slot: "+k+" ("+v+")";var m=new j.AttachmentTimeline(l.length);m.slotIndex=x;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n++,q.time,q.name)}d.push(m),e=Math.max(e,m.frames[Math.floor(m.getFrameCount())-1])}}}c.animations.push(new j.Animation(a,d,e))}},j.SkeletonJson.readCurve=function(a,b,c){var d=c.curve;d&&("stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]))},j.SkeletonJson.toColor=function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+a;return parseInt(a.substr(2*b,2),16)/255},j.Atlas=function(a,b){this.textureLoader=b,this.pages=[],this.regions=[];var c=new j.AtlasReader(a),d=[];d.length=4;for(var e=null;;){var f=c.readLine();if(null==f)break;if(f=c.trim(f),0==f.length)e=null;else if(e){var g=new j.AtlasRegion;g.name=f,g.page=e,g.rotate="true"==c.readValue(),c.readTuple(d);var h=parseInt(d[0]),i=parseInt(d[1]);c.readTuple(d);var k=parseInt(d[0]),l=parseInt(d[1]);g.u=h/e.width,g.v=i/e.height,g.rotate?(g.u2=(h+l)/e.width,g.v2=(i+k)/e.height):(g.u2=(h+k)/e.width,g.v2=(i+l)/e.height),g.x=h,g.y=i,g.width=Math.abs(k),g.height=Math.abs(l),4==c.readTuple(d)&&(g.splits=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],4==c.readTuple(d)&&(g.pads=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],c.readTuple(d))),g.originalWidth=parseInt(d[0]),g.originalHeight=parseInt(d[1]),c.readTuple(d),g.offsetX=parseInt(d[0]),g.offsetY=parseInt(d[1]),g.index=parseInt(c.readValue()),this.regions.push(g)}else{e=new j.AtlasPage,e.name=f,e.format=j.Atlas.Format[c.readValue()],c.readTuple(d),e.minFilter=j.Atlas.TextureFilter[d[0]],e.magFilter=j.Atlas.TextureFilter[d[1]];var m=c.readValue();e.uWrap=j.Atlas.TextureWrap.clampToEdge,e.vWrap=j.Atlas.TextureWrap.clampToEdge,"x"==m?e.uWrap=j.Atlas.TextureWrap.repeat:"y"==m?e.vWrap=j.Atlas.TextureWrap.repeat:"xy"==m&&(e.uWrap=e.vWrap=j.Atlas.TextureWrap.repeat),b.load(e,f),this.pages.push(e)}}},j.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},j.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},j.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},j.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},j.AtlasPage=function(){},j.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},j.AtlasRegion=function(){},j.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},j.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)},j.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw"Invalid line: "+b;for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f){if(0==d)throw"Invalid line: "+b;break}a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},j.AtlasAttachmentLoader=function(a){this.atlas=a},j.AtlasAttachmentLoader.prototype={newAttachment:function(a,b,c){switch(b){case j.AttachmentType.region:var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" ("+b+")";var e=new j.RegionAttachment(c);return e.rendererObject=d,e.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e}throw"Unknown attachment type: "+b}},e.AnimCache={},j.Bone.yDown=!0,e.CustomRenderable=function(){e.DisplayObject.call(this)},e.CustomRenderable.constructor=e.CustomRenderable,e.CustomRenderable.prototype=Object.create(e.DisplayObject.prototype),e.CustomRenderable.prototype.renderCanvas=function(){},e.CustomRenderable.prototype.initWebGL=function(){},e.CustomRenderable.prototype.renderWebGL=function(){},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTexture=function(a){if(e.EventTarget.call(this),this.width=100,this.height=100,this.source=a,a){if(this.source instanceof Image)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var b=this;this.source.onload=function(){b.hasLoaded=!0,b.width=b.source.width,b.height=b.source.height,e.texturesToUpdate.push(b),b.dispatchEvent({type:"loaded",content:b})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);this._powerOf2=!1}},e.BaseTexture.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null),this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.fromImage=function(a,c){var d=b(a),f=e.BaseTextureCache[d];if(!f){var g=new Image;c&&(g.crossOrigin=""),g.src=a,f=new e.BaseTexture(g),e.BaseTextureCache[d]=f}return f},e.TextureCache={},e.FrameCache={},e.Texture=function(a,b){if(e.EventTarget.call(this),b||(this.noFrame=!0,b=new e.Rectangle(0,0,1,1)),this.height=1,this.width=1,this.frame=b,a instanceof e.Texture&&(b.x+=a.frame.x,b.y+=a.frame.y,a=a.baseTexture),this.baseTexture=a,this.scope=this,a.hasLoaded)this.noFrame&&(b=new e.Rectangle(0,0,a.width,a.height)),this.setFrame(b);else{var c=this;a.addEventListener("loaded",function(){c.onBaseTextureLoaded()})}},e.Texture.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;a.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,a.width,a.height)),this.noFrame=!1,this.realSize?(this.width=this.realSize.width,this.height=this.realSize.height):(this.width=this.frame.width,this.height=this.frame.height),this.scope.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(a){a&&this.baseTexture.destroy()},e.Texture.prototype.setFrame=function(a){if(this.frame=a,this.realSize?(this.width=this.realSize.width,this.height=this.realSize.height):(this.width=a.width,this.height=a.height),a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,e.Texture.frameUpdates.push(this)},e.Texture.fromImage=function(a,c){var d=b(a),f=e.TextureCache[d];return f||(f=new e.Texture(e.BaseTexture.fromImage(a,c)),e.TextureCache[d]=f),f},e.Texture.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error("The frameId '"+a+"' does not exist in the texture cache "+this);return b},e.Texture.fromCanvas=function(a){var b=new e.BaseTexture(a);return new e.Texture(b)},e.Texture.addTextureToCache=function(a,b){e.TextureCache[b]=a},e.Texture.removeTextureFromCache=function(a){var b=e.TextureCache[a];return e.TextureCache[a]=null,b},e.Texture.frameUpdates=[],e.RenderTexture=function(a,b){e.EventTarget.call(this),this.width=a||100,this.height=b||100,this.indetityMatrix=e.mat3.create(),this.frame=new e.Rectangle(0,0,this.width,this.height),e.gl?this.initWebGL():this.initCanvas()},e.RenderTexture.constructor=e.RenderTexture,e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.initWebGL=function(){var a=e.gl;this.glFramebuffer=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,this.glFramebuffer),this.glFramebuffer.width=this.width,this.glFramebuffer.height=this.height,this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTexture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.baseTexture._glTexture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),this.baseTexture.isRender=!0,a.bindFramebuffer(a.FRAMEBUFFER,this.glFramebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.baseTexture._glTexture,0),this.projectionMatrix=e.mat4.create(),this.projectionMatrix[5]=2/this.height,this.projectionMatrix[13]=-1,this.projectionMatrix[0]=2/this.width,this.projectionMatrix[12]=-1,this.render=this.renderWebGL},e.RenderTexture.prototype.initCanvas=function(){this.renderer=new e.CanvasRenderer(this.width,this.height,null,0),this.baseTexture=new e.BaseTexture(this.renderer.view),this.frame=new e.Rectangle(0,0,this.width,this.height),this.render=this.renderCanvas},e.RenderTexture.prototype.renderWebGL=function(a,b){var c=e.gl;c.colorMask(!0,!0,!0,!0),c.viewport(0,0,this.width,this.height),c.bindFramebuffer(c.FRAMEBUFFER,this.glFramebuffer),b&&(c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT));var d=a.children;a.worldTransform=e.mat3.create();for(var f=0,g=d.length;g>f;f++)d[f].updateTransform();var h=a.__renderGroup;h?a==h.root?h.render(this.projectionMatrix):h.renderSpecific(a,this.projectionMatrix):(this.renderGroup||(this.renderGroup=new e.WebGLRenderGroup(c)),this.renderGroup.setRenderable(a),this.renderGroup.render(this.projectionMatrix))},e.RenderTexture.prototype.renderCanvas=function(a,b){var c=a.children;a.worldTransform=e.mat3.create();for(var d=0,f=c.length;f>d;d++)c[d].updateTransform();b&&this.renderer.context.clearRect(0,0,this.width,this.height),this.renderer.renderDisplayObject(a),e.texturesToUpdate.push(this.baseTexture)},e.AssetLoader=function(a){e.EventTarget.call(this),this.assetURLs=a,this.crossorigin=!1,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,json:e.JsonLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.constructor=e.AssetLoader,e.AssetLoader.prototype.load=function(){var a=this;this.loadCount=this.assetURLs.length;for(var b=0;b<this.assetURLs.length;b++){var c=this.assetURLs[b],d=c.substring(c.lastIndexOf(".")+1).toLowerCase();-1!=d.indexOf("?")&&(d=d.substring(0,d.indexOf("?")));var e=this.loadersByType[d];if(!e)throw new Error(d+" is an unsupported file type");var f=new e(c,this.crossorigin);f.addEventListener("loaded",function(){a.onAssetLoaded()}),f.load()}},e.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.crossorigin=b,this.loaded=!1,this.versioning=null,-1!=a.indexOf("?")&&(this.versioning=a.substring(a.indexOf("?")))},e.JsonLoader.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){this.ajaxRequest=new i;var a=this;this.ajaxRequest.onreadystatechange=function(){a.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.JsonLoader.prototype.onJSONLoaded=function(){if(4==this.ajaxRequest.readyState)if(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var a=this,c=this.baseUrl+this.json.meta.image+(this.versioning?this.versioning:""),d=new e.ImageLoader(c,this.crossorigin),f=this.json.frames;this.texture=d.texture,d.addEventListener("loaded",function(){a.onLoaded()});for(var g in f){var h=f[g],i=h.frame;if(i){var k=e.TextureCache[g]=new e.Texture(this.texture,{x:i.x,y:i.y,width:i.w,height:i.h});h.trimmed&&(k.realSize=new e.Rectangle(-h.spriteSourceSize.x,-h.spriteSourceSize.y,h.sourceSize.w,h.sourceSize.h))}}d.load()}else if(this.json.bones){var l=new j.SkeletonJson,m=l.readSkeletonData(this.json);e.AnimCache[b(this.url)]=m,this.onLoaded()}else this.onLoaded();else this.onError()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.versioning=null,-1!=a.indexOf("?")&&(this.versioning=a.substring(a.indexOf("?"))),this.texture=null,this.frames={},this.crossorigin=b},e.SpriteSheetLoader.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onJSONLoaded()}),b.load()},e.SpriteSheetLoader.prototype.onJSONLoaded=function(){var a=this,b=this.baseUrl+this.json.meta.image+(this.versioning?this.versioning:""),c=new e.ImageLoader(b,this.crossorigin),d=this.json.frames;this.texture=c.texture,c.addEventListener("loaded",function(){a.onLoaded()});for(var f in d){var g=d[f],h=g.frame;if(h){var i=e.TextureCache[f]=new e.Texture(this.texture,{x:h.x,y:h.y,width:h.w,height:h.h});g.trimmed&&(i.realSize=new e.Rectangle(-g.spriteSourceSize.x,-g.spriteSourceSize.y,g.sourceSize.w,g.sourceSize.h))}}c.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(a,b){e.EventTarget.call(this),this.texture=e.Texture.fromImage(a,b)},e.ImageLoader.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var a=this;this.texture.baseTexture.addEventListener("loaded",function(){a.onLoaded()})}},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.BitmapFontLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null,this.crossorigin=b},e.BitmapFontLoader.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var a=this;this.ajaxRequest.onreadystatechange=function(){a.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var a=this.baseUrl+this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue,b=new e.ImageLoader(a,this.crossorigin);this.texture=b.texture;var c={},d=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],f=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];c.font=d.attributes.getNamedItem("face").nodeValue,c.size=parseInt(d.attributes.getNamedItem("size").nodeValue,10),c.lineHeight=parseInt(f.attributes.getNamedItem("lineHeight").nodeValue,10),c.chars={};for(var g,h=this.ajaxRequest.responseXML.getElementsByTagName("char"),i=0,j=h.length;j>i;i++){g=h[i].attributes;var k=parseInt(g.getNamedItem("id").nodeValue,10),l={x:parseInt(g.getNamedItem("x").nodeValue,10),y:parseInt(g.getNamedItem("y").nodeValue,10),width:parseInt(g.getNamedItem("width").nodeValue,10),height:parseInt(g.getNamedItem("height").nodeValue,10)};c.chars[k]={xOffset:parseInt(g.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(g.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(g.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:new e.Texture(this.texture,l)}}var m=this.ajaxRequest.responseXML.getElementsByTagName("kerning");for(i=0,j=m.length;j>i;i++){g=m[i].attributes;var n=parseInt(g.getNamedItem("first").nodeValue,10),o=parseInt(g.getNamedItem("second").nodeValue,10),p=parseInt(g.getNamedItem("amount").nodeValue,10);c.chars[o].kerning[n]=p}e.BitmapText.fonts[c.font]=c;var q=this;b.addEventListener("loaded",function(){q.onLoaded()}),b.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.loaded=!1},e.SpineLoader.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){new e.JsonLoader(this.url,this.crossorigin),jsonLoader.addEventListener("loaded",function(a){scope.json=a.content.json,scope.onJSONLoaded()}),jsonLoader.load()},e.SpineLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onJSONLoaded()}),b.load()},e.SpineLoader.prototype.onJSONLoaded=function(){var a=new j.SkeletonJson,c=a.readSkeletonData(this.json);e.AnimCache[b(this.url)]=c,this.onLoaded()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):d.PIXI=e}.call(this);